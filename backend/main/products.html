<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Detail produktu</title>
</head>
<body>
<a href="products.html">← Zpět na produkty</a>

<h1 id="title">Načítám...</h1>

<div id="error" style="color: red;"></div>
<div id="product"></div>

<script>
    function getIdFromUrl() {
        const params = new URLSearchParams(window.location.search);
        return params.get("id");
    }

    async function loadProduct() {
        const id = getIdFromUrl();
        const error = document.getElementById("error");
        const container = document.getElementById("product");
        const title = document.getElementById("title");

        try {
            const res = await fetch("http://localhost:8000/products");

            if (!res.ok) {
                throw new Error("Server vrátil chybu: " + res.status);
            }

            const data = await res.json();
            const p = data.find(item => item.id == id);

            if (!p) {
                title.textContent = "Produkt nenalezen";
                return;
            }

            title.textContent = p.name;

            container.innerHTML = `
                <p><strong>Cena:</strong> ${p.price ?? "?"} Kč</p>
                <p><strong>Kategorie:</strong> ${p.category}</p>
                <p><strong>Brand:</strong> ${p.brand ?? "—"}</p>
                <p><strong>Popis:</strong> ${p.description ?? "—"}</p>
                <p><strong>URL:</strong> <a href="${p.url}" target="_blank">${p.url}</a></p>
            `;
        } catch (e) {
            console.error(e);
            error.textContent = "Chyba při načítání detailu produktu.";
        }
    }

    loadProduct();
</script>
</body>
</html>
